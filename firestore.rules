rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Entidades - lectura y escritura pública (TEMPORAL PARA MIGRACIÓN)
    // TODO: Cambiar a "if request.auth != null" después de migrar
    match /entities/{entityId} {
      allow read, write: if true; // Simplificado para desarrollo
      
      // Casos de uso dentro de entidades
      match /useCases/{useCaseId} {
        allow read, write: if true;
        
        // Métricas históricas por periodo
        match /metrics/{period} {
          allow read, write: if true;
        }
        match /technicalMetrics/{period} {
          allow read, write: if true;
        }
        match /businessMetrics/{period} {
          allow read, write: if true;
        }
        match /financialMetrics/{period} {
          allow read, write: if true;
        }
        match /generalInfo/{period} {
          allow read, write: if true;
        }

        // Historial de versiones del caso de uso
        match /history/{versionId} {
          allow read, write: if true;
        }
      }
    }
    
    // Configuración global (periodos disponibles, etc)
    match /config/{document} {
      allow read, write: if true;
    }
  }
}
